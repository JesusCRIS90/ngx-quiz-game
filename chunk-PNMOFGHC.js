import{a as U}from"./chunk-YVRS7HEF.js";import{a as P,b as K,f as J}from"./chunk-RDP67BV4.js";import{c as R,d as G,e as W,f as j,h as N,i as Y}from"./chunk-K54WLUOZ.js";import{$,A as b,B as w,C as a,D as s,E as M,F as y,H as g,I as d,L as x,M as v,N as T,O as p,S as V,T as E,da as B,e as A,f as u,fa as q,g as m,h as f,ia as O,ja as k,m as I,n as z,p as c,q as C,s as _,sa as H,u as F,v as r,y as L,z as S}from"./chunk-5OR52EUV.js";var D=class o{http=u($);constructor(){}getQuestions(e){let t=[];t.push(`amount=${e.numberQuestions}`),e.category&&e.category.id&&t.push(`category=${H(e.category.id)}`),e.difficulty&&e.difficulty.id&&t.push(`difficulty=${e.difficulty.id}`),e.type&&e.type.id&&t.push(`type=${e.type.id}`);let i=t.join("&"),n=`${k}?${i}`;return this.http.get(n)}static \u0275fac=function(t){return new(t||o)};static \u0275prov=A({token:o,factory:o.\u0275fac,providedIn:"root"})};var h=class o{message;static \u0275fac=function(t){return new(t||o)};static \u0275cmp=_({type:o,selectors:[["app-common-error-window"]],inputs:{message:"message"},decls:2,vars:3,consts:[[1,"error-message",3,"innerHTML"]],template:function(t,i){t&1&&(M(0,"p",0),V(1,"formatMessage")),t&2&&r("innerHTML",E(1,1,i.message),z)},dependencies:[J],encapsulation:2})};var ee=["difficultyComponents"],te=["typeComponents"];function ie(o,e){if(o&1){let t=y();a(0,"switchable-icon",10),g("outState",function(n){m(t);let l=d(2);return f(l.updateCategorySelected(n))}),s()}if(o&2){let t=e.$implicit,i=d(2);r("iconInfo",i.getIconInfo(t))("id",t.id)}}function oe(o,e){if(o&1){let t=y();a(0,"switchable-text",11,0),g("outState",function(n){m(t);let l=d(2);return f(l.updateDifficultySelected(n))}),s()}if(o&2){let t=e.$implicit;r("selectedText",t)}}function ne(o,e){if(o&1){let t=y();a(0,"switchable-text",11,1),g("outState",function(n){m(t);let l=d(2);return f(l.updateTypeSelected(n))}),s()}if(o&2){let t=e.$implicit;r("selectedText",t)}}function re(o,e){if(o&1){let t=y();a(0,"bee-center-layout")(1,"bee-fixed-width-layout",2)(2,"div",3)(3,"h1"),p(4,"Category"),s(),a(5,"bee-grid-1d-layout",4),b(6,ie,1,2,"switchable-icon",5,S),s(),a(8,"bee-grid-1d-layout",6)(9,"bee-vertical-layout")(10,"h1"),p(11,"Difficulty"),s(),a(12,"bee-horizontal-layout",7),b(13,oe,2,1,"switchable-text",8,S),s()(),a(15,"bee-vertical-layout")(16,"h1"),p(17,"Type"),s(),a(18,"bee-horizontal-layout",7),b(19,ne,2,1,"switchable-text",8,S),s()()(),a(21,"bee-vertical-layout")(22,"button",9),g("click",function(){m(t);let n=d();return f(n.getQuizQuestions())}),p(23,"Start"),s()()()()()}if(o&2){let t=d();c(),r("width",950),c(4),r("inputGridDistribution","1fr 1fr 1fr 1fr 1fr 1fr")("gap",10),c(),w(t.getCategories()),c(2),r("inputGridDistribution","50% auto"),c(4),r("gap",20),c(),w(t.getDifficulties()),c(5),r("gap",20),c(),w(t.getTypes()),c(3),r("disabled",t.disableBtn())}}function ae(o,e){o&1&&(a(0,"p"),p(1,"Error Loading Data from Storage"),s())}var Q=class o{constructor(e,t,i){this.router=e;this.quizService=t;this.modalService=i;this.getDataFromStorage()}categoriesComponents;difficultyComponents;typeComponents;storage=u(q);quizApi=u(D);rootPath="";categories=[];difficulty=[];type=[];selectedCategory=null;selectedDifficulty=null;selectedType=null;loadedData=I(!1);disableBtn=I(!1);getDataFromStorage(){let e=this.storage.getStorageDataFromKey(O);if(e!==null){this.rootPath=e.selectionPage.rootPath,this.categories=e.selectionPage.categories,this.difficulty=e.selectionPage.difficultyLevel,this.type=e.selectionPage.type,this.loadedData.set(!0);return}this.loadedData.set(!1)}getCategories(){return this.categories}getRootPath(){return this.rootPath}getDifficulties(){return this.difficulty}getTypes(){return this.type}getIconInfo(e){return{name:e.name,icon:`${this.getRootPath()}/${e.icon}.png`,id:e.id}}getApiQuizParams(){return{category:this.selectedCategory,difficulty:this.selectedDifficulty,type:this.selectedType,numberQuestions:10}}getQuizQuestions(){this.disableBtn.set(!0),this.quizApi.getQuestions(this.getApiQuizParams()).subscribe({next:e=>{e.response_code===0?(this.prepareNewGame(e.results),this.router.navigate(["/quiz-game"])):(this.modalService.open({component:h,data:{message:`It seems that your Quiz Configurations is not valid. 
 Please choose another one.`}}),this.disableBtn.set(!1))},error:e=>{console.error("Failed to fetch users",e),this.modalService.open({component:h,data:{message:`Error Type:${e.statusText}.
Message:${e.message}`}}),this.disableBtn.set(!1)}})}prepareNewGame(e){this.quizService.newGame(e)}updateCategorySelected(e){if(this.selectedCategory!==null&&this.selectedCategory.id===e.id&&e.state===1){this.find_and_disactivate_with_id(e.id,this.selectedCategory,this.categoriesComponents),this.selectedCategory=null;return}if(this.selectedCategory!==null&&this.selectedCategory.id!==e.id){let t=this.categoriesComponents.find(i=>i.getId()===this.selectedCategory.id);t&&t.disactivate()}this.selectedCategory=e}updateDifficultySelected(e){if(this.selectedDifficulty!==null&&this.selectedDifficulty.id===e.id&&e.state===1){this.find_and_disactivate_with_id(e.id,this.selectedDifficulty,this.difficultyComponents),this.selectedDifficulty=null;return}if(this.selectedDifficulty!==null&&this.selectedDifficulty.id!==e.id){let t=this.difficultyComponents.find(i=>i.getId()===this.selectedDifficulty.id);t&&t.disactivate()}this.selectedDifficulty=e}updateTypeSelected(e){if(this.selectedType!==null&&this.selectedType.id===e.id&&e.state===1){this.find_and_disactivate_with_id(e.id,this.selectedType,this.typeComponents),this.selectedType=null;return}if(this.selectedType!==null&&this.selectedType.id!==e.id){let t=this.typeComponents.find(i=>i.getId()===this.selectedType.id);t&&t.disactivate()}this.selectedType=e}find_and_disactivate_with_id(e,t,i){let n=i.find(l=>l.getId()===t.id);n&&n.disactivate()}static \u0275fac=function(t){return new(t||o)(C(B),C(Y),C(U))};static \u0275cmp=_({type:o,selectors:[["app-selection-page"]],viewQuery:function(t,i){if(t&1&&(x(P,5),x(ee,5),x(te,5)),t&2){let n;v(n=T())&&(i.categoriesComponents=n),v(n=T())&&(i.difficultyComponents=n),v(n=T())&&(i.typeComponents=n)}},decls:2,vars:1,consts:[["difficultyComponents",""],["typeComponents",""],[1,"page-selection",3,"width"],[1,"config-container"],[1,"categories",3,"inputGridDistribution","gap"],[1,"switchable-icon",3,"iconInfo","id"],[3,"inputGridDistribution"],[3,"gap"],[1,"switchable-text",3,"selectedText"],[1,"btn-start-game",3,"click","disabled"],[1,"switchable-icon",3,"outState","iconInfo","id"],[1,"switchable-text",3,"outState","selectedText"]],template:function(t,i){t&1&&F(0,re,24,7,"bee-center-layout")(1,ae,2,0,"p"),t&2&&L(i.loadedData()?0:1)},dependencies:[R,G,W,N,j,K,P],encapsulation:2})};export{Q as default};
